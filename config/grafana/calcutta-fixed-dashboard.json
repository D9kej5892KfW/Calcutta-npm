{
  "dashboard": {
    "id": null,
    "uid": "calcutta-final-v3",
    "title": "Calcutta - Working Events & Workflow Analytics",
    "description": "Fully working dashboard with 20 panels based on actual data structure (labels: tool, event, session, workflow)",
    "tags": ["calcutta", "fixed", "working", "agent-telemetry"],
    "timezone": "browser",
    "refresh": "30s",
    "time": {
      "from": "now-6h",
      "to": "now"
    },
    "style": "dark",
    "theme": "dark",
    "templating": {
      "list": [
        {
          "name": "tool",
          "type": "query",
          "label": "üîß Tool Filter",
          "query": "label_values({service=\"claude-telemetry\"}, tool)",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
          "multi": true,
          "includeAll": true,
          "allValue": ".*",
          "current": {"selected": true, "text": "All", "value": "$__all"}
        },
        {
          "name": "session",
          "type": "query",
          "label": "üë§ Session Filter",
          "query": "label_values({service=\"claude-telemetry\"}, session)",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
          "multi": true,
          "includeAll": true,
          "allValue": ".*",
          "current": {"selected": true, "text": "All", "value": "$__all"}
        },
        {
          "name": "interval",
          "type": "interval",
          "label": "‚è±Ô∏è Time Interval",
          "query": "30s,1m,5m,15m,30m,1h,3h",
          "auto": true,
          "auto_min": "30s",
          "current": {"selected": false, "text": "auto", "value": "$__auto_interval_interval"}
        }
      ]
    },
    "panels": [
      {
        "id": 1,
        "title": "üéØ Calcutta Overview",
        "type": "row",
        "collapsed": false,
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 0}
      },
      {
        "id": 2,
        "title": "üìä Total Operations",
        "type": "stat",
        "description": "Total telemetry events captured",
        "targets": [{
          "expr": "sum(count_over_time({service=\"claude-telemetry\", tool=~\"$tool\", event=~\"$event\", session=~\"$session\"}[$interval]))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"}
        }],
        "fieldConfig": {
          "defaults": {
            "color": {"mode": "thresholds"},
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"color": "#1F2937", "value": null},
                {"color": "#059669", "value": 100},
                {"color": "#2563EB", "value": 1000},
                {"color": "#7C3AED", "value": 5000}
              ]
            },
            "unit": "short", "min": 0, "decimals": 0
          }
        },
        "gridPos": {"h": 6, "w": 4, "x": 0, "y": 1},
        "options": {"colorMode": "background", "graphMode": "area", "justifyMode": "center"}
      },
      {
        "id": 3,
        "title": "‚ö° Activity Rate",
        "type": "stat",
        "description": "Operations per minute",
        "targets": [{
          "expr": "sum(rate({service=\"claude-telemetry\", tool=~\"$tool\", event=~\"$event\", session=~\"$session\"}[$interval])) * 60",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"}
        }],
        "fieldConfig": {
          "defaults": {
            "color": {"mode": "thresholds"},
            "thresholds": {
              "steps": [
                {"color": "#374151", "value": null},
                {"color": "#059669", "value": 5},
                {"color": "#F59E0B", "value": 20},
                {"color": "#DC2626", "value": 50}
              ]
            },
            "unit": "ops/min", "min": 0, "decimals": 1
          }
        },
        "gridPos": {"h": 6, "w": 4, "x": 4, "y": 1},
        "options": {"colorMode": "background", "graphMode": "area"}
      },
      {
        "id": 4,
        "title": "üîß Active Tools",
        "type": "stat",
        "description": "Unique tools in use",
        "targets": [{
          "expr": "count(count by (tool) (count_over_time({service=\"claude-telemetry\", tool=~\"$tool\", event=~\"$event\", session=~\"$session\"}[$interval])))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"}
        }],
        "fieldConfig": {
          "defaults": {
            "color": {"mode": "thresholds"},
            "thresholds": {
              "steps": [
                {"color": "#374151", "value": null},
                {"color": "#2563EB", "value": 2},
                {"color": "#059669", "value": 3},
                {"color": "#7C3AED", "value": 4}
              ]
            },
            "unit": "short", "min": 0, "decimals": 0
          }
        },
        "gridPos": {"h": 6, "w": 4, "x": 8, "y": 1},
        "options": {"colorMode": "background", "graphMode": "area"}
      },
      {
        "id": 5,
        "title": "üë• Active Sessions",
        "type": "stat",
        "description": "Session count",
        "targets": [{
          "expr": "count(count by (session) (count_over_time({service=\"claude-telemetry\", session=~\"$session\"}[$interval])))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"}
        }],
        "fieldConfig": {
          "defaults": {
            "color": {"mode": "thresholds"},
            "thresholds": {
              "steps": [
                {"color": "#374151", "value": null},
                {"color": "#2563EB", "value": 1},
                {"color": "#059669", "value": 2},
                {"color": "#F59E0B", "value": 4}
              ]
            },
            "unit": "short", "min": 0, "decimals": 0
          }
        },
        "gridPos": {"h": 6, "w": 4, "x": 12, "y": 1},
        "options": {"colorMode": "background", "graphMode": "area"}
      },
      {
        "id": 6,
        "title": "üìù Task Management Rate",
        "type": "stat",
        "description": "% of TodoWrite tool usage (task management proxy)",
        "targets": [{
          "expr": "(sum(count_over_time({service=\"claude-telemetry\", tool=\"TodoWrite\", session=~\"$session\"}[$interval])) / sum(count_over_time({service=\"claude-telemetry\", session=~\"$session\"}[$interval]))) * 100 or 0",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"}
        }],
        "fieldConfig": {
          "defaults": {
            "color": {"mode": "thresholds"},
            "thresholds": {
              "steps": [
                {"color": "#6B7280", "value": null},
                {"color": "#F59E0B", "value": 5},
                {"color": "#059669", "value": 15},
                {"color": "#2563EB", "value": 30}
              ]
            },
            "unit": "percent", "min": 0, "max": 100, "decimals": 1
          }
        },
        "gridPos": {"h": 6, "w": 4, "x": 16, "y": 1},
        "options": {"colorMode": "background", "graphMode": "area"}
      },
      {
        "id": 7,
        "title": "üéØ Workflow Distribution",
        "type": "stat",
        "description": "Standard vs other workflows",
        "targets": [{
          "expr": "count by (workflow) (count_over_time({service=\"claude-telemetry\", session=~\"$session\"}[$interval]))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"}
        }],
        "fieldConfig": {
          "defaults": {
            "color": {"mode": "thresholds"},
            "thresholds": {
              "steps": [
                {"color": "#374151", "value": null},
                {"color": "#2563EB", "value": 1},
                {"color": "#059669", "value": 2}
              ]
            },
            "unit": "short", "min": 0, "decimals": 0
          }
        },
        "gridPos": {"h": 6, "w": 4, "x": 20, "y": 1},
        "options": {"colorMode": "background", "graphMode": "area"}
      },
      {
        "id": 8,
        "title": "üìà Tool Usage Analytics",
        "type": "row",
        "collapsed": false,
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 7}
      },
      {
        "id": 9,
        "title": "üîß Tool Usage Timeline",
        "type": "timeseries",
        "description": "Tool activity patterns over time",
        "targets": [{
          "expr": "sum by (tool) (rate({service=\"claude-telemetry\", tool=~\"$tool\", event=~\"$event\", session=~\"$session\"}[$interval]))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
          "legendFormat": "{{tool}}"
        }],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "drawStyle": "line", "lineInterpolation": "smooth", "lineWidth": 2,
              "fillOpacity": 15, "gradientMode": "opacity", "spanNulls": true,
              "showPoints": "never", "stacking": {"mode": "none"}
            },
            "color": {"mode": "palette-classic"}, "unit": "ops/s", "min": 0, "decimals": 3
          }
        },
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8},
        "options": {
          "tooltip": {"mode": "multi", "sort": "desc"},
          "legend": {"displayMode": "table", "placement": "bottom", "calcs": ["lastNotNull", "mean", "max"]}
        }
      },
      {
        "id": 10,
        "title": "ü•ß Tool Distribution",
        "type": "piechart",
        "description": "Tool usage distribution",
        "targets": [{
          "expr": "sort_desc(sum by (tool) (count_over_time({service=\"claude-telemetry\", tool=~\"$tool\", event=~\"$event\", session=~\"$session\"}[$interval])))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
          "legendFormat": "{{tool}}"
        }],
        "fieldConfig": {
          "defaults": {"color": {"mode": "palette-classic"}, "unit": "short", "decimals": 0}
        },
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8},
        "options": {
          "pieType": "pie", "tooltip": {"mode": "single"},
          "legend": {"displayMode": "table", "placement": "right", "values": ["value", "percent"]},
          "displayLabels": ["name", "percent"]
        }
      },
      {
        "id": 11,
        "title": "üìä Event Type Analytics",
        "type": "row",
        "collapsed": false,
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 16}
      },
      {
        "id": 12,
        "title": "üìã Event Type Timeline",
        "type": "timeseries",
        "description": "Event type patterns: file_read, file_write, command_execution",
        "targets": [{
          "expr": "sum by (event) (rate({service=\"claude-telemetry\", session=~\"$session\"}[$interval]))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
          "legendFormat": "{{event}}"
        }],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "drawStyle": "line", "lineInterpolation": "smooth", "lineWidth": 2,
              "fillOpacity": 20, "showPoints": "auto", "stacking": {"mode": "none"}
            },
            "color": {"mode": "palette-classic"}, "unit": "ops/s", "decimals": 3
          }
        },
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 17},
        "options": {
          "tooltip": {"mode": "multi", "sort": "desc"},
          "legend": {"displayMode": "table", "placement": "bottom", "calcs": ["lastNotNull", "mean", "max"]}
        }
      },
      {
        "id": 13,
        "title": "üìä Event Distribution",
        "type": "piechart",
        "description": "Distribution of event types",
        "targets": [{
          "expr": "sort_desc(sum by (event) (count_over_time({service=\"claude-telemetry\", session=~\"$session\"}[$interval])))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
          "legendFormat": "{{event}}"
        }],
        "fieldConfig": {
          "defaults": {"color": {"mode": "palette-spectrum"}, "unit": "short", "decimals": 0}
        },
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 17},
        "options": {
          "pieType": "pie", "tooltip": {"mode": "single"},
          "legend": {"displayMode": "table", "placement": "right", "values": ["value", "percent"]},
          "displayLabels": ["name", "percent"]
        }
      },
      {
        "id": 14,
        "title": "üìÇ File Operations Analysis",
        "type": "timeseries",
        "description": "File read vs write operations",
        "targets": [
          {
            "expr": "sum(rate({service=\"claude-telemetry\", event=\"file_read\", session=~\"$session\"}[$interval]))",
            "refId": "A",
            "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
            "legendFormat": "File Reads/sec"
          },
          {
            "expr": "sum(rate({service=\"claude-telemetry\", event=\"file_write\", session=~\"$session\"}[$interval]))",
            "refId": "B",
            "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
            "legendFormat": "File Writes/sec"
          },
          {
            "expr": "sum(rate({service=\"claude-telemetry\", event=\"command_execution\", session=~\"$session\"}[$interval]))",
            "refId": "C",
            "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
            "legendFormat": "Commands/sec"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "drawStyle": "line", "lineInterpolation": "smooth", "lineWidth": 2,
              "fillOpacity": 15, "showPoints": "never", "stacking": {"mode": "none"}
            },
            "color": {"mode": "palette-classic"}, "unit": "ops/s", "decimals": 3
          }
        },
        "gridPos": {"h": 6, "w": 24, "x": 0, "y": 25},
        "options": {
          "tooltip": {"mode": "multi", "sort": "desc"},
          "legend": {"displayMode": "table", "placement": "bottom", "calcs": ["lastNotNull", "mean", "max"]}
        }
      },
      {
        "id": 15,
        "title": "‚è±Ô∏è Session & Workflow Analytics",
        "type": "row",
        "collapsed": false,
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 31}
      },
      {
        "id": 16,
        "title": "üë§ Session Activity Heatmap",
        "type": "timeseries",
        "description": "Activity per session over time",
        "targets": [{
          "expr": "sum by (session) (rate({service=\"claude-telemetry\", session=~\"$session\"}[$interval]))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
          "legendFormat": "{{session}}"
        }],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "drawStyle": "line", "lineInterpolation": "smooth", "lineWidth": 2,
              "fillOpacity": 20, "showPoints": "auto", "stacking": {"mode": "none"}
            },
            "color": {"mode": "palette-classic"}, "unit": "ops/s", "decimals": 3
          }
        },
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 32},
        "options": {
          "tooltip": {"mode": "multi", "sort": "desc"},
          "legend": {"displayMode": "table", "placement": "bottom", "calcs": ["lastNotNull", "mean"]}
        }
      },
      {
        "id": 17,
        "title": "üéØ Tool Usage Analysis",
        "type": "timeseries",
        "description": "Tool usage patterns over time",
        "targets": [{
          "expr": "sum by (tool) (rate({service=\"claude-telemetry\", session=~\"$session\"}[$interval]))",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
          "legendFormat": "{{tool}}"
        }],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "drawStyle": "bars", "lineWidth": 1, "fillOpacity": 80,
              "stacking": {"mode": "normal"}, "spanNulls": false
            },
            "color": {"mode": "palette-spectrum"}, "unit": "ops/s", "decimals": 3
          }
        },
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 32},
        "options": {
          "tooltip": {"mode": "multi", "sort": "desc"},
          "legend": {"displayMode": "table", "placement": "bottom", "calcs": ["lastNotNull", "max"]}
        }
      },
      {
        "id": 18,
        "title": "üìà Performance & Data Quality",
        "type": "row",
        "collapsed": false,
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 40}
      },
      {
        "id": 19,
        "title": "üìä Comprehensive Analytics Table",
        "type": "table",
        "description": "Tool and event usage statistics",
        "targets": [
          {
            "expr": "sort_desc(sum by (tool) (count_over_time({service=\"claude-telemetry\", tool=~\"$tool\", session=~\"$session\"}[$interval])))",
            "refId": "A",
            "datasource": {"type": "loki", "uid": "aetvioshimfwge"},
            "format": "table",
            "instant": true
          }
        ],
        "fieldConfig": {
          "defaults": {"color": {"mode": "palette-classic"}, "unit": "short", "decimals": 0},
          "overrides": [
            {
              "matcher": {"id": "byName", "options": "tool"},
              "properties": [
                {"id": "displayName", "value": "üîß Tool Name"},
                {"id": "custom.width", "value": 180}
              ]
            },
            {
              "matcher": {"id": "byName", "options": "Value"},
              "properties": [
                {"id": "displayName", "value": "üìä Usage Count"},
                {"id": "custom.width", "value": 140}
              ]
            }
          ]
        },
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 41},
        "options": {"showHeader": true, "sortBy": [{"displayName": "üìä Usage Count", "desc": true}]}
      },
      {
        "id": 20,
        "title": "üîç Live Activity Stream",
        "type": "logs",
        "description": "Real-time telemetry event stream",
        "targets": [{
          "expr": "{service=\"claude-telemetry\", tool=~\"$tool\", session=~\"$session\"}",
          "refId": "A",
          "datasource": {"type": "loki", "uid": "aetvioshimfwge"}
        }],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 41},
        "options": {
          "showTime": true, "showLabels": true, "showCommonLabels": false,
          "wrapLogMessage": true, "prettifyLogMessage": false,
          "enableLogDetails": true, "dedupStrategy": "none", "sortOrder": "Descending"
        }
      }
    ]
  }
}